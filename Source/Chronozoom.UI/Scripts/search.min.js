var ChronoZoom;(function(n){(function(t){function h(){n.Tours.isTourWindowVisible&&n.Tours.onTourClicked&&n.Tours.onTourClicked(),t.isSearchWindowVisible?(n.Common.toggleOffImage("search_button"),$("#search").hide("slide",{},"slow")):(n.Common.toggleOnImage("search_button"),$("#search").show("slide",{},"slow",function(){$("#searchTextBox").focus()})),t.isSearchWindowVisible=!t.isSearchWindowVisible}function c(t){var i=n.Common.setVisibleByUserDirectly(t.newvisible);i&&(n.Common.setNavigationStringTo={element:t.element,id:i})}function l(t){var i,r;t&&(i=n.UrlNav.navStringToVisible(t,$("#vc")),i&&(r=n.Common.setVisibleByUserDirectly(i),r&&(n.Common.setNavigationStringTo={bookmark:t,id:r})))}function e(t){var i=a($("#vc").virtualCanvas("getLayerContent"),t),r;i?(r=n.VCContent.getVisibleForElement(i,1,$("#vc").virtualCanvas("getViewport")),c({element:i,newvisible:r})):alert("Element not found in the content.")}function a(n,t){var r=t.charAt(0)==="c",i=function(n,t){var e,u,f,o,s;if(n.id===t)return n;if(!n.children)return null;for(e=n.children.length,u=0;u<e;u++)if(f=n.children[u],f.id===t)return f;for(u=0;u<e;u++)if(f=n.children[u],o=i(f,t),o)return o;return r&&n.type==="infodot"&&(s=getContentItem(n,t),s!=null)?s:null};return i(n,t)}function f(n,t){var i,f,h;(s($("#searchTextBox")[0].value).indexOf(n)===0||n==="")&&(i=$("#search .searchResults").empty(),t==null||(t.length==0?$("<div class='searchNoResult'>No results<\/div>").appendTo(i):(f=function(n,r){for(var s=!0,u,o,f=0;f<t.length;f++)if(u=t[f],u.ObjectType==n){switch(u.ObjectType){case 0:o="e"+u.UniqueID;break;case 1:o="t"+u.UniqueID;break;case 2:o="c"+u.UniqueID;break;default:continue}s&&($("<div class='searchResultSection'>"+r+"<\/div>").appendTo(i),s=!1),$("<div class='searchResult' resultId='"+o+"'>"+t[f].Title+"<\/div>").appendTo(i).click(function(){e(this.getAttribute("resultId"))})}},f(1,"Timelines"),f(0,"Exhibits"),f(2,"Artifacts")))),u&&(u=!1),r!=null&&(h=r,r=null,o(h)),$("#loadingImage").fadeOut("slow")}function o(t){if(u){r=t;return}if(u=!0,!t||t===""){setTimeout(function(){f(t)},1);return}var i;switch(n.Settings.czDataSource){case"db":i="Chronozoom.svc/Search";break;default:i="Chronozoom.svc/SearchRelay"}$.ajax({cache:!1,type:"GET",async:!0,dataType:"json",data:{searchTerm:t},url:i,success:function(result){n.Settings.czDataSource=="db"?f(t,result.d):f(t,eval(result.d))},error:function(n){alert("Error connecting to service: "+n.responseText)}})}function s(n){return n===null?"":(n&&(n=n.replace(new RegExp('"',"g"),"")),n)}var i,r,u;t.isSearchWindowVisible=!1,i=null,t.onSearchClicked=h,t.navigateToBookmark=l,t.goToSearchResult=e,r=null,u=!1})(n.Search||(n.Search={}));var t=n.Search})(ChronoZoom||(ChronoZoom={}))