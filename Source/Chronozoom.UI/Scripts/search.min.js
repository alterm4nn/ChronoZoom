var ChronoZoom;(function(n){(function(t){function c(){n.Tours.isTourWindowVisible&&n.Tours.onTourClicked&&n.Tours.onTourClicked(),t.isSearchWindowVisible?(n.Common.toggleOffImage("search_button"),$("#search").hide("slide",{},"slow")):(n.Common.toggleOnImage("search_button"),$("#search").show("slide",{},"slow",function(){$("#searchTextBox").focus()})),t.isSearchWindowVisible=!t.isSearchWindowVisible}function l(i){i?n.Common.toggleOnImage("search_button"):t.isSearchWindowVisible||n.Common.toggleOffImage("search_button")}function a(){$("#searchTextBox").focus(function(){$(this).hasClass("emptyTextBox")&&(this.value="",$(this).removeClass("emptyTextBox"))}).blur(function(){$(this).hasClass("emptyTextBox")?this.value!=""&&$(this).removeClass("emptyTextBox"):this.value==""&&(this.value="type here...",$(this).addClass("emptyTextBox"))}).keyup(function(){i&&(clearTimeout(i),i=null),i=setTimeout(function(){$("#searchTextBox").val()!=""&&$("#loadingImage").fadeIn("slow"),s(h($("#searchTextBox")[0].value.substr(0,700)))},300)}),$("#search").hide()}function e(t){var i=n.Common.setVisibleByUserDirectly(t.newvisible);i&&(n.Common.setNavigationStringTo={element:t.element,id:i})}function v(t){var i,r;t&&(i=n.UrlNav.navStringToVisible(t,n.Common.vc),i&&(r=n.Common.setVisibleByUserDirectly(i),r&&(n.Common.setNavigationStringTo={bookmark:t,id:r})))}function o(t){var i=y(n.Common.vc.virtualCanvas("getLayerContent"),t),r;i?(r=n.VCContent.getVisibleForElement(i,1,n.Common.vc.virtualCanvas("getViewport")),e({element:i,newvisible:r})):alert("Element not found in the content.")}function y(t,i){var u=i.charAt(0)==="c",r=function(t,i){var o,f,e,s,h;if(t.id===i)return t;if(!t.children)return null;for(o=t.children.length,f=0;f<o;f++)if(e=t.children[f],e.id===i)return e;for(f=0;f<o;f++)if(e=t.children[f],s=r(e,i),s)return s;return u&&t.type==="infodot"&&(h=n.VCContent.getContentItem(t,i),h!=null)?h:null};return r(t,i)}function f(n,t){var i,f,e;(h($("#searchTextBox")[0].value).indexOf(n)===0||n==="")&&(i=$("#search .searchResults").empty(),t==null||(t.length==0?$("<div class='searchNoResult'>No results<\/div>").appendTo(i):(f=function(n,r){for(var s=!0,u,e,f=0;f<t.length;f++)if(u=t[f],u.ObjectType==n){switch(u.ObjectType){case 0:e="e"+u.UniqueID;break;case 1:e="t"+u.UniqueID;break;case 2:e="c"+u.UniqueID;break;default:continue}s&&($("<div class='searchResultSection'>"+r+"<\/div>").appendTo(i),s=!1),$("<div class='searchResult' resultId='"+e+"'>"+t[f].Title+"<\/div>").appendTo(i).click(function(){o(this.getAttribute("resultId"))})}},f(1,"Timelines"),f(0,"Exhibits"),f(2,"Artifacts")))),u&&(u=!1),r!=null&&(e=r,r=null,s(e)),$("#loadingImage").fadeOut("slow")}function s(t){if(u){r=t;return}if(u=!0,!t||t===""){setTimeout(function(){f(t)},1);return}var i;switch(n.Settings.czDataSource){case"db":i="/Chronozoom.svc/Search";break;default:i="/Chronozoom.svc/SearchRelay"}$.ajax({cache:!1,type:"GET",async:!0,dataType:"json",data:{searchTerm:t,supercollection:n.Common.supercollection,collection:n.Common.collection},url:i,success:function(result){n.Settings.czDataSource=="db"?f(t,result.d):f(t,eval(result.d))},error:function(n){alert("Error connecting to service: "+n.responseText)}})}function h(n){return n===null?"":(n&&(n=n.replace(new RegExp('"',"g"),"")),n)}var i,r,u;t.isSearchWindowVisible=!1,i=null,t.onSearchClicked=c,t.searchHighlight=l,t.initializeSearch=a,t.navigateToElement=e,t.navigateToBookmark=v,t.goToSearchResult=o,r=null,u=!1})(n.Search||(n.Search={}));var t=n.Search})(ChronoZoom||(ChronoZoom={}));
//@ sourceMappingURL=search.min.js.map