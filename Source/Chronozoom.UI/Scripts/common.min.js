function updateNavigator(n){var u=function(n){if(Math.abs(n)<1e-11)return 0;var t=Math.log(n)/2.3025850929940459,i=Math.pow(t,3)*Math.exp(-t*.001);return(t+i)*137e8/1041.2113538234403},i=n.pointScreenToVirtual(0,0).x,t;i<Settings.maxPermitedTimeRange.left&&(i=Settings.maxPermitedTimeRange.left),t=n.pointScreenToVirtual(n.width,n.height).x,t>Settings.maxPermitedTimeRange.right&&(t=Settings.maxPermitedTimeRange.right);var o=u(Math.abs(t)),f=u(Math.abs(i)),s=Math.max(2/regimesRatio,Math.abs(o-f)),h=document.getElementById("cosmos_rect").clientWidth,r=301-regimesRatio*f,e=regimesRatio*s;r<0||r+e>h+5||(regimeNavigator.css("left",r),regimeNavigator.css("width",e))}function setCookie(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i),u=escape(t)+(i==null?"":"; expires="+r.toUTCString()),document.cookie=n+"="+u}function getCookie(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u);return null}var ChronoZoom;(function(n){(function(t){function rt(n,t){var i,r;return i=t.pageX-n[0].offsetLeft,r=t.pageY-n[0].offsetTop,{x:i,y:r}}function ut(n){n&&n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function ft(n){return n===9999?0:k(n,0,0)}function k(n,t,i){var r=a();return d(n,t,i,r.presentYear,r.presentMonth,r.presentDay)}function et(n){var t=a();return ot(t.presentYear,t.presentMonth,t.presentDay,n)}function a(){return f||(f=new Date,f.presentDay=f.getUTCDate(),f.presentMonth=f.getUTCMonth(),f.presentYear=f.getUTCFullYear()),f}function d(n,t,r,u,f,e){var h=u-n,c,o,s,l,a;for(u>0&&n<0&&(h-=1),c=f-t,(t>f||t==f&&r>e)&&(h--,c+=12),o=t,s=-r,l=0;l<c;l++)o==12&&(o=0),s+=i.daysInMonth[o],o++;return s+=e,a=h+s/365,-a}function ot(n,t,r,u){var e=n,f=t,o=r,s,c,h;for(e-=Math.floor(-u),s=(u+Math.floor(-u))*365;s<0;)c=f>0?f-1:11,s+=i.daysInMonth[c],f--,f<0&&(e--,f=11);for(o+=Math.round(s),h=i.daysInMonth[f];o>h;)o-=h,f++,f>11&&(f=0,e++),h=i.daysInMonth[f];return e<0&&n>0&&(e-=1),{year:e,month:f,day:o}}function st(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="on"&&(u=f+"_off."+t,$("#"+n).attr("src",u))}function ht(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="ff"&&(u=f+"on."+t,$("#"+n).attr("src",u))}function lt(n,t){return t!=null?Math.abs(n.centerX-t.centerX)<i.allowedVisibileImprecision&&Math.abs(n.centerY-t.centerY)<i.allowedVisibileImprecision&&Math.abs(n.scale-t.scale)<i.allowedVisibileImprecision:!1}function at(n){return u.pauseTourAtAnyAnimation=!1,u.tour!=undefined&&u.tour.state=="play"&&u.tourPause(),g(n)}function g(n){if(n)return t.controller.moveToVisible(n)}function vt(t){if(timings.wcfRequestCompleted=new Date,n.Layout.Load(r,t.d),timings.layoutCompleted=new Date,o&&(s=n.UrlNav.navStringToVisible(o.substring(1),r)),nt(),!s&&e&&(window.location.hash=e,s=n.UrlNav.navStringToVisible(e,r)),s){r.virtualCanvas("setVisible",s),updateAxis(r,c);var i=r.virtualCanvas("getViewport");updateNavigator(i),o&&window.location.hash!==o&&(hashChangeFromOutside=!1,window.location.hash=o)}timings.canvasInited=new Date}function nt(){var f,u,o,s,h,c;l&&l.d.length>0&&(f=function(t){if(!t)return null;var i=r.virtualCanvas("findElement","t"+t.UniqueID);return it.push(i),i&&(i=n.UrlNav.vcelementToNavString(i)),i},u=l.d[0],e=f(u),n.UrlNav.navigationAnchor=r.virtualCanvas("findElement","t"+u.UniqueID),o=n.Layout.FindChildTimeline(u,i.earthTimelineID),y=f(o),s=n.Layout.FindChildTimeline(o,i.lifeTimelineID),p=f(s),h=n.Layout.FindChildTimeline(s,i.prehistoryTimelineID),w=f(h),c=n.Layout.FindChildTimeline(h,i.humanityTimelineID,!0),b=f(c),t.maxPermitedVerticalRange={top:u.y,bottom:u.y+u.height},t.maxPermitedScale=n.UrlNav.navStringToVisible(e,r).scale*1.1)}var i=n.Settings,u=n.Tours,tt,h,f,v,ct;t.maxPermitedScale,t.maxPermitedVerticalRange,tt=[],t.controller;var o,c,r,s,e,y,p,w,b,l,it=[];t.setNavigationStringTo,t.hashHandle=!0,h=undefined,t.getXBrowserMouseOrigin=rt,t.preventbubble=ut,t.getCoordinateFromDecimalYear=ft,t.getCoordinateFromDMY=k,t.getDMYFromCoordinate=et,f=undefined,t.getPresent=a,t.toggleOffImage=st,t.toggleOnImage=ht,v=null,ct="default",t.compareVisibles=lt,t.setVisibleByUserDirectly=at,t.setVisible=g})}),updateAxis(vc,ax);var vp=vc.virtualCanvas("getViewport"),lt=vp.pointScreenToVirtual(0,0),rb=vp.pointScreenToVirtual(vp.width,vp.height);ax.axis("setRange",lt.x,rb.x),Common=ChronoZoom.Common