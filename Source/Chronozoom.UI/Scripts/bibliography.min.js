var ChronoZoom;(function(n){(function(t){function u(){$("#bibliographyBack").hide(),$("#biblCloseButton").mouseup(function(){i=null,$("#bibliographyBack").hide("clip",{},"slow"),window.location.hash=window.location.hash.replace(new RegExp("&b=[a-z0-9_]+$","gi"),"")})}function r(t,i,u){var e,h,o,s,c;try{e=n.VCContent.getChild(i,u)}catch(l){return}h=n.Common.vc.virtualCanvas("getViewport"),o=n.UrlNav.vcelementToNavString(i,h),window.location.hash.match("b=([a-z0-9_]+)")==null&&(s="&b="+u,window.location.hash.indexOf("@")==-1&&(s="@"+s),o=o+s),window.location.hash=o,e.onmouseclick=null,c=$("#bibliographyBack").css("display"),$("#bibliographyBack").css("display")=="none"?$("#bibliographyBack").show("clip",{},"slow",function(){e.onmouseclick=function(){return n.Common.vc.element.css("cursor","default"),r({infodot:t.infodot,contentItems:t.contentItems},i,u),!0}}):e.onmouseclick=function(){return n.Common.vc.element.css("cursor","default"),r({infodot:t.infodot,contentItems:t.contentItems},i,u),!0},$("#bibliography .sources").empty(),$("#bibliography .title").html("<span><\/span> &gt; Bibliography"),t&&(t.infodot?($("#bibliography .title span").html(t.infodot.title),f(t.infodot.guid,t.contentItems)):$("#bibliography .title span").html(""))}function f(t,r){i=t;var f=function(n){var s,e,u,o,f;if(t==i&&(s=$("#bibliography .sources"),s.empty(),n)){if(n.sort(function(n,t){return n.Authors&&t.Authors?n.Authors>t.Authors?1:-1:n.Authors?1:t.Authors?-1:n.title&&t.title?n.title>t.title?1:-1:n.title?1:t.title?-1:0}),n.length!=0)for($('<div class="sectionTitle" id="biblAdditionalResources">Additional Resources<\/div>').appendTo(s),e=0;e<n.length;e++)u=n[e],o=$('<div class="source"><\/div>').appendTo(s),$('<div class="sourceName"><a href="'+u.Source+'" target="_blank">'+u.Source+"<a/><\/div>").appendTo(o),f=u.Authors?u.Authors:"",u.title&&(f!=""&&(f+="<br>"),f+="<i>"+u.title+"<\/i>"),u.Publication&&(f!=""&&(f+="<br>"),f+=u.Publication),u.PublicationDates&&(f!=""&&(f+=", "),f+=u.PublicationDates),u.PageNumbers&&(f!=""&&(f+=", "),f+=u.PageNumbers),$('<div class="sourceDescr">'+f+"<\/div>").appendTo(o);if(r.length!=0)for($('<div class="sectionTitle" id="biblAdditionalResources">Current Resources<\/div>').appendTo(s),e=0;e<r.length;e++)u=r[e],o=$('<div class="source"><\/div>').appendTo(s),u.mediaSource?$('<div class="sourceName"><a href="'+u.mediaSource+'" target="_blank">'+u.mediaSource+"<a/><\/div>").appendTo(o):$("<br/>").appendTo(o),f="",u.title&&(f+="<i>"+u.title+"<\/i>"),u.attribution&&(f!=""&&(f+="<br>"),f+=u.attribution),$('<div class="sourceDescr">'+f+"<\/div>").appendTo(o)}},u;switch(n.Settings.czDataSource){case"db":u="/Chronozoom.svc/GetBibliography";break;default:u="/Chronozoom.svc/GetBibliographyRelay"}$.ajax({cache:!1,type:"GET",async:!0,dataType:"json",data:{exhibitID:t},url:u,success:function(result){n.Settings.czDataSource=="db"?f(result.d):f(eval(result.d))},error:function(n){alert("Error connecting to service: "+n.responseText)}})}t.initializeBibliography=u;var i=null;t.showBibliography=r})(n.Bibliography||(n.Bibliography={}));var t=n.Bibliography})(ChronoZoom||(ChronoZoom={}))