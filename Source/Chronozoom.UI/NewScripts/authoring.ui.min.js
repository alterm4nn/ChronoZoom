var CZ=function(n,t){function i(n,i){var r=t("<div class='cz-authoring-ci-container'><\/div>"),e=t("<p><label>Title<\/label><input class='cz-authoring-ci-title' style='display: block' type='text'/><\/p>"),o=t("<p><label style='display: block'>Description<\/label><textarea class='cz-authoring-ci-description' style='display: block' /><\/p>"),s=t("<p><label>Media source<\/label><input class='cz-authoring-ci-media-source' style='display: block' type='text'/><\/p>"),h=t("<p><label>Media type<\/label><select class='cz-authoring-ci-media-type' style='display: block'><option value='image'>Image<\/option><option value='pdf'>PDF<\/option> <option value='video'>Video<\/option><option value='audio'>Audio<\/option><\/select><\/p>"),u=t("<button>Remove content item<\/button>"),f;u[0].onclick=function(){r.remove()},r.append(e),r.append(o),r.append(s),r.append(h),r.append(u),i==!0&&(f=t("<hr />"),r.append(f)),n.append(r)}function u(){var n=[],i=t(".cz-authoring-ci-container");return t(".cz-authoring-ci-container").each(function(){for(var f=t(this).find(".cz-authoring-ci-title"),e=t(this).find(".cz-authoring-ci-media-source"),r=t(this).find(".cz-authoring-ci-media-type option"),o=t(this).find(".cz-authoring-ci-description"),s=t(this).attr("cz-authoring-ci-guid")||null,u=r[0],i=0;i<r.length;i++)r[i].selected&&(u=r[i]);n.push({title:f.val(),description:o.val(),uri:e.val(),mediaType:u.text,guid:s,parent:null})}),n}function f(n,i){var u=n.find(".cz-authoring-ci-title"),f=n.find(".cz-authoring-ci-media-source"),e=n.find(".cz-authoring-ci-media-type option"),o=n.find(".cz-authoring-ci-description"),r=i.mediaType.toLowerCase();r==="picture"&&(r="image"),n.attr("cz-authoring-ci-guid",i.guid),u.val(i.title),f.val(i.uri),o.val(i.description),e.each(function(){if(this.value===r){t(this).attr("selected","selected");return}})}var r=n.Authoring=n.Authoring||{},e=r.UI=r.UI||{};return t.extend(e,{showCreateTimelineForm:function(i){var e=!0,f=t("#timelineTitleInput"),r=t("#timelineStartInput").spinner(),u=t("#timelineEndInput").spinner();f.val(i.title),r.val(i.x),u.val(i.x+i.width),t("#createTimelineForm").dialog({title:"create timeline",modal:!0,height:600,width:600,buttons:{"save and close":function(){var o=n.Authoring.ValidateNumber(r.val())&&n.Authoring.ValidateNumber(u.val()),s;o=o&&n.Authoring.IsNotEmpty(f.val())&&n.Authoring.IsNotEmpty(r.val())&&n.Authoring.IsNotEmpty(u.val()),o||t("#TimelineErrorSpan").css("display","block"),o&&(s=this,e=!1,n.Authoring.updateTimeline(i,{title:f.val(),start:r.val(),end:u.val()}).then(function(){t(s).dialog("close")},function(n){alert("Unable to save changes. Please try again later."),console.log(n)}))}},close:function(){e&&n.Authoring.removeTimeline(i),n.Authoring._isActive=!1,t("#TimelineErrorSpan").css("display","none"),t("a:contains('create timeline')").removeClass("active")}})},showEditTimelineForm:function(i){var f=t("#timelineTitleInput").spinner(),r=t("#timelineStartInput").spinner(),u=t("#timelineEndInput").spinner();f.val(i.title),r.val(i.x),u.val(i.x+i.width),t("#createTimelineForm").dialog({title:"edit timeline",modal:!0,height:600,width:600,buttons:{"save and close":function(){var e=n.Authoring.ValidateNumber(r.val())&&n.Authoring.ValidateNumber(u.val()),o;e=e&&n.Authoring.IsNotEmpty(f.val())&&n.Authoring.IsNotEmpty(r.val())&&n.Authoring.IsNotEmpty(u.val()),e||t("#TimelineErrorSpan").css("display","block"),e&&(o=this,n.Authoring.updateTimeline(i,{title:f.val(),start:r.val(),end:u.val()}).then(function(){t(o).dialog("close")},function(n){alert("Unable to save changes. Please try again later."),console.log(n)}))},"delete":function(){confirm("Are you sure want to delete timeline and all of its nested timelines and exhibits? Delete can't be undone!")&&(n.Authoring.removeTimeline(i),t(this).dialog("close"))}},close:function(){n.Authoring._isActive=!1,t("a:contains('edit timeline')").removeClass("active"),t("#TimelineErrorSpan").css("display","none")}})},showCreateExhibitForm:function(r){var c=!0,o=t("#exhibitTitleInput"),e=t("#exhibitDateInput").spinner(),s,h;for(o.val(r.title),e.val(r.infodotDescription.date),s=r.contentItems,h=0;h<s.length;h++)i(t("#createExhibitForm"),!0);t(".cz-authoring-ci-container").each(function(n){f(t(this),s[n])}),t("#createExhibitForm").dialog({title:"create exhibit",modal:!0,height:600,width:600,buttons:{"save and close":function(){var f=u(),i=n.Authoring.ValidateNumber(e.val());i=i&&n.Authoring.IsNotEmpty(o.val())&&n.Authoring.IsNotEmpty(e.val()),i=i&&n.Authoring.ValidateContentItems(f),i?(n.Authoring.updateExhibit(r,{title:o.val(),date:e.val(),contentItems:f}),c=!1,t(this).dialog("close")):t("#ExhibitErrorSpan").css("display","block")},"add content item":function(){t(this).find(".cz-authoring-ci-container").length<infodotMaxContentItemsCount&&i(t(this),!0)}},close:function(){c&&n.Authoring.removeExhibit(r),n.Authoring._isActive=!1,t("a:contains('create exhibit')").removeClass("active"),t("#ExhibitErrorSpan").css("display","none"),t(this).find(".cz-authoring-ci-container").each(function(){t(this).remove()})}})},showEditExhibitForm:function(r){var s=t("#exhibitTitleInput"),o=t("#exhibitDateInput").spinner(),e,h;for(s.val(r.title),o.val(r.infodotDescription.date),e=r.contentItems,h=0;h<e.length;h++)i(t("#createExhibitForm"),!0);t(".cz-authoring-ci-container").each(function(n){f(t(this),e[n])}),t("#createExhibitForm").dialog({title:"edit exhibit",modal:!0,height:600,width:600,buttons:{"save and close":function(){e=u(r);var i=n.Authoring.ValidateNumber(o.val());i=i&&n.Authoring.IsNotEmpty(s.val())&&n.Authoring.IsNotEmpty(o.val()),i=i&&n.Authoring.ValidateContentItems(e),i?(n.Authoring.updateExhibit(r,{title:s.val(),date:o.val(),contentItems:e}),t(this).dialog("close"),t(this).find(".cz-authoring-ci-container").each(function(){t(this).remove()})):t("#ExhibitErrorSpan").css("display","block")},"delete":function(){confirm("Are you sure want to delete exhibit and all of its content items? Delete can't be undone!")&&(n.Authoring.removeExhibit(r),t(this).dialog("close"))},"add content item":function(){t(this).find(".cz-authoring-ci-container").length<infodotMaxContentItemsCount&&i(t("#createExhibitForm"),!0)}},close:function(){n.Authoring._isActive=!1,t("a:contains('edit exhibit')").removeClass("active"),t("#ExhibitErrorSpan").css("display","none"),t(this).find(".cz-authoring-ci-container").each(function(){t(this).remove()})}})},showEditContentItemForm:function(i,r){var e=t("#contentItemTitleInput"),o=t("#contentItemMediaSourceInput"),s=t("#contentItemDescriptionInput"),u=t("#contentItemMediaTypeInput option"),f=i.contentItem.mediaType.toLowerCase();f==="picture"&&(f="image"),e.val(i.contentItem.title),o.val(i.contentItem.uri),s.val(i.contentItem.description),u.each(function(){if(this.value===f){t(this).attr("selected","selected");return}}),t("#editContentItemForm").dialog({title:"Edit content item",modal:!0,height:600,width:600,buttons:{"save and close":function(){for(var h=u[0],f=1;f<u.length;f++)u[f].selected&&(h=u[f]);console.log(i,r),n.Authoring.updateContentItem(i,{title:e.val(),uri:o.val(),mediaType:h.text,description:s.val()}),t(this).dialog("close")},"delete":function(){confirm("Are you sure want to delete content item? Delete can't be undone!")&&(n.Authoring.removeContentItem(i),t(this).dialog("close"))}},close:function(){n.Authoring._isActive=!1,t("a:contains('edit exhibit')").removeClass("active")}})},createTimeline:function(){animatingElements.length==0&&(n.Authoring._isActive=n.Authoring.mode!=="createTimeline"||!n.Authoring._isActive,n.Authoring.mode="createTimeline",t("div #footer-authoring > a").removeClass("active"),n.Authoring._isActive?t("a:contains('create timeline')").addClass("active"):t("a:contains('create timeline')").removeClass("active"))},editTimeline:function(){animatingElements.length==0&&(n.Authoring._isActive=n.Authoring.mode!=="editTimeline"||!n.Authoring._isActive,n.Authoring.mode="editTimeline",t("div #footer-authoring > a").removeClass("active"),n.Authoring._isActive?t("a:contains('edit timeline')").addClass("active"):t("a:contains('edit timeline')").removeClass("active"))},createExhibit:function(){animatingElements.length==0&&(n.Authoring._isActive=n.Authoring.mode!=="createExhibit"||!n.Authoring._isActive,n.Authoring.mode="createExhibit",t("div #footer-authoring > a").removeClass("active"),n.Authoring._isActive?t("a:contains('create exhibit')").addClass("active"):t("a:contains('create exhibit')").removeClass("active"))},editExhibit:function(){animatingElements.length==0&&(n.Authoring._isActive=n.Authoring.mode!=="editExhibit"||!n.Authoring._isActive,n.Authoring.mode="editExhibit",t("div #footer-authoring > a").removeClass("active"),n.Authoring._isActive?t("a:contains('edit exhibit')").addClass("active"):t("a:contains('edit exhibit')").removeClass("active"))}}),n}(CZ||{},jQuery)