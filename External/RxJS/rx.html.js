// Copyright (c) Microsoft Corporation.  All rights reserved.
// This code is licensed by Microsoft Corporation under the terms
// of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
// See http://go.microsoft.com/fwlink/?LinkId=186234.

(function(){var a=this;var b;if(typeof ProvideCustomRxRootObject =="undefined")b=a.Rx; else b=ProvideCustomRxRootObject();var c=undefined;var d=b.Observable;var e=b.AsyncSubject;var f=d.Create;var g=function(j){var k={};for(var l in j) k[l]=j[l];return k;};var h=d.FromIEEvent=function(j,k){return f(function(l){var m=function(){l.OnNext(g(a.event));};j.attachEvent(k,m);return function(){j.detachEvent(k,m);};});};d.FromHtmlEvent=function(j,k){if(j.attachEvent!==c)return h(j,"on"+k); else return i(j,k);};var i=d.FromDOMEvent=function(j,k){return f(function(l){var m=function(n){l.OnNext(g(n));};j.addEventListener(k,m,false);return function(){j.removeEventListener(k,m,false);};});};d.XmlHttpRequest=function(j){if(typeof j =="string")j={Method:"GET",Url:j};var k=new e();try{var l=new XMLHttpRequest();if(j.Headers!==c){var m=j.Headers;for(var n in m) l.setRequestHeader(n,m[n]);}l.open(j.Method,j.Url,true,j.User,j.Password);l.onreadystatechange=function(){if(l.readyState==4){var p=l.status;if(p>=200&&p<300||p==0||p==""){k.OnNext(l);k.OnCompleted();}else k.OnError(l);}};l.send(j.Body);}catch(p){k.OnError(p);}var o=new b.RefCountDisposable(b.Disposable.Create(function(){if(l.readyState!=4){l.abort();k.OnError(l);}}));return d.CreateWithDisposable(function(p){return new b.CompositeDisposable(k.Subscribe(p),o.GetDisposable());});};})();